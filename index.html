<!DOCTYPE html>
<html>
<head>
<title>Kisan Price Mitra - India</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="bg-light">
<div class="container py-5">

<h2 class="text-center text-success mb-4">
ğŸŒ¾ Pan India Crop Intelligence Platform
</h2>

<div class="card p-4 shadow">

<form method="POST" class="row g-3">

<div class="col-md-4">
<label>Select Crop</label>
<select name="crop" class="form-select" required>
{% for crop in crops %}
<option value="{{ crop }}">{{ crop }}</option>
{% endfor %}
</select>
</div>

<div class="col-md-4">
<label>Select State</label>
<select name="state" class="form-select" required>
{% for state in states %}
<option value="{{ state }}">{{ state }}</option>
{% endfor %}
</select>
</div>

<div class="col-md-4">
<label>Quantity (Quintals)</label>
<input type="number" name="quantity" class="form-control" required>
</div>

<div class="col-12 text-center">
<button class="btn btn-success px-4">Analyze</button>
</div>

</form>

{% if prices %}

<hr>

<h5>ğŸ“Š Price Trend</h5>
<canvas id="chart"></canvas>

<div class="alert alert-warning mt-3">
ğŸ”® Predicted Price: â‚¹ {{ predicted_price }}
</div>

<div class="alert alert-info">
{{ recommendation }}
</div>

<h5 class="mt-4">ğŸ“ Mandi Details</h5>

<table class="table table-bordered text-center">
<thead class="table-success">
<tr>
<th>Name</th>
<th>Distance</th>
<th>Price</th>
<th>Transport</th>
<th>Net Profit</th>
<th>Map</th>
</tr>
</thead>
<tbody>
{% for mandi in nearby_mandis %}
<tr>
<td>{{ mandi.name }}</td>
<td>{{ mandi.distance }} km</td>
<td>â‚¹ {{ mandi.price }}</td>
<td>â‚¹ {{ mandi.transport }}</td>
<td>â‚¹ {{ mandi.net }}</td>
<td>
<a href="https://www.google.com/maps/search/{{ mandi.maps_query }}"
target="_blank" class="btn btn-sm btn-primary">
View
</a>
</td>
</tr>
{% endfor %}
</tbody>
</table>

<script>
var priceData = JSON.parse('{{ prices | tojson }}');
new Chart(document.getElementById('chart'),{
type:'line',
data:{
labels:Array.from({length:priceData.length},(_,i)=>'Day '+(i+1)),
datasets:[{label:'Price (â‚¹)',data:priceData,tension:0.3}]
}
});
</script>

{% endif %}

</div>
</div>
</body>
</html>